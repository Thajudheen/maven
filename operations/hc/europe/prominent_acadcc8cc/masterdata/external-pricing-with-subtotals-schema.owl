<?xml version="1.0"?>


<!DOCTYPE rdf:RDF [
<!ENTITY owl "http://www.w3.org/2002/07/owl#" >
<!ENTITY swrl "http://www.w3.org/2003/11/swrl#" >
<!ENTITY swrlb "http://www.w3.org/2003/11/swrlb#" >
<!ENTITY xsd "http://www.w3.org/2001/XMLSchema#" >
<!ENTITY afn "http://jena.hpl.hp.com/ARQ/function#" >
<!ENTITY rdfs "http://www.w3.org/2000/01/rdf-schema#" >
<!ENTITY xpath-fn "http://www.w3.org/2005/xpath-functions#" >
<!ENTITY rdf "http://www.w3.org/1999/02/22-rdf-syntax-ns#" >
<!ENTITY ssc "http://www.inmindcomputing.com/ssc/submodel.owl#" >
<!ENTITY ps "http://www.inmindcomputing.com/platform/platform-schema.owl#" >
<!ENTITY as "http://www.inmindcomputing.com/application/application-schema.owl#" >
<!ENTITY ase "http://www.inmindcomputing.com/application/application-schema-ext.owl#" >
<!ENTITY ai "http://www.inmindcomputing.com/application/application-implementation.owl#" >
]>


<rdf:RDF xmlns="http://www.inmindcomputing.com/application/application-schema-ext.owl#"
     xml:base="http://www.inmindcomputing.com/application/application-schema-ext.owl"
     xmlns:afn="http://jena.hpl.hp.com/ARQ/function#"
     xmlns:ssc="http://www.inmindcomputing.com/ssc/submodel.owl#"
     xmlns:xpath-fn="http://www.w3.org/2005/xpath-functions#"
     xmlns:as="http://www.inmindcomputing.com/application/application-schema.owl#"
     xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
     xmlns:swrl="http://www.w3.org/2003/11/swrl#"
     xmlns:ai="http://www.inmindcomputing.com/application/application-implementation.owl#"
     xmlns:ase="http://www.inmindcomputing.com/application/application-schema-ext.owl#"
     xmlns:owl="http://www.w3.org/2002/07/owl#"
     xmlns:xsd="http://www.w3.org/2001/XMLSchema#"
     xmlns:swrlb="http://www.w3.org/2003/11/swrlb#"
     xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
     xmlns:ps="http://www.inmindcomputing.com/platform/platform-schema.owl#">
	<owl:Ontology rdf:about="http://www.inmindcomputing.com/scenario/external-pricing-with-subtotals-schema.owl">
		<owl:versionInfo rdf:datatype="&xsd;string">0.4</owl:versionInfo>
		<rdfs:comment rdf:datatype="&xsd;string">Copyright (c) 2013, In Mind Computing AG. All rights reserved.
IMC PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</rdfs:comment>
		<owl:imports rdf:resource="http://www.inmindcomputing.com/application/application-schema.owl"/>
	</owl:Ontology>

	<!--
    ///////////////////////////////////////////////////////////////////////////////////////
    //
    // Data properties
    //
    ///////////////////////////////////////////////////////////////////////////////////////
     -->

	<owl:DatatypeProperty rdf:about="&ase;zListPriceHeader">
		<rdf:type rdf:resource="&owl;FunctionalProperty"/>
		<rdfs:domain rdf:resource="&as;Quote"/>
		<ps:hidden rdf:datatype="&xsd;boolean">true</ps:hidden>
		<rdfs:subPropertyOf rdf:resource="&ps;calculation"/>
		<rdfs:subPropertyOf rdf:resource="&ps;materialization"/>
		<rdfs:range rdf:resource="&xsd;decimal"/>
	</owl:DatatypeProperty>
	<rdf:Description rdf:about="&ase;zListPriceHeader1">
		<ps:defaultValue rdf:datatype="&xsd;decimal">0</ps:defaultValue>
		<ps:sparqlDefault rdf:datatype="&xsd;string">
		SELECT ?subject (SUM(?val) as ?zListPriceHeader1)
		WHERE {

		?subject rdf:type as:Quote .
		?subject as:includesSalesItem+ ?si .
		?si as:salesItemOptional true .
		?si as:includesItemHeaderPriceItem ?ihpi .
		?ihpi as:includesPriceItem ?pi .
		?pi as:hasPriceItemType ?pt .
		?pt as:objectERPId &apos;PR00&apos; .

		{
		  SELECT DISTINCT ?pi ?val
		  WHERE
		  {
				 ?pi as:priceItemTargetAmount ?cp .
				 BIND (xsd:decimal(?cp) AS ?val )
		  }
		}
	   } GROUP BY ?subject
		</ps:sparqlDefault>
	</rdf:Description>

	<!-- http://www.inmindcomputing.com/application/application-schema-ext.owl#zDiscountHeaderTotal -->

	<owl:DatatypeProperty rdf:about="&ase;zDiscountHeaderTotal">
		<rdf:type rdf:resource="&owl;FunctionalProperty"/>
		<rdfs:label rdf:datatype="&xsd;string">Discount Total</rdfs:label>
		<rdfs:label xml:lang="de">Total Discount (Base currency):</rdfs:label>
		<rdfs:label xml:lang="en">Total Discount (Base currency):</rdfs:label>
		<ps:sequenceID rdf:datatype="&xsd;int">3</ps:sequenceID>
		<ps:group rdf:resource="&ase;QuoteAdditionalAttributes-Margin"/>
		<rdfs:domain rdf:resource="&as;Quote"/>
		<ps:readOnly rdf:datatype="&xsd;boolean">true</ps:readOnly>
		<rdfs:subPropertyOf rdf:resource="&ps;calculation"/>
		<rdfs:range rdf:resource="&xsd;decimal"/>
	</owl:DatatypeProperty>
	<rdf:Description rdf:about="&ase;zDiscountHeaderTotal">
		<ps:defaultValue rdf:datatype="&xsd;decimal">0</ps:defaultValue>
		<ps:sparqlDefault rdf:datatype="&xsd;string">
		SELECT ?subject (?val as ?zDiscountHeaderTotal)
		WHERE {
			?subject ase:zListPriceHeader ?cc .
			?subject as:includesDocumentHeaderPriceItem ?docHPI .
			?docHPI as:documentHeaderPrice ?cp .      
			BIND (( xsd:decimal(?cc) - xsd:decimal(?cp))  AS ?val)
		}
		 </ps:sparqlDefault>
	</rdf:Description>

	<!-- http://www.inmindcomputing.com/application/application-schema-ext.owl#zDiscountHeaderPercentage -->

	<owl:DatatypeProperty rdf:about="&ase;zDiscountHeaderPercentage">
		<rdf:type rdf:resource="&owl;FunctionalProperty"/>
		<rdfs:label rdf:datatype="&xsd;string">Discount Percentage</rdfs:label>
		<rdfs:label xml:lang="de">Total Discount (%):</rdfs:label>
		<rdfs:label xml:lang="en">Total Discount (%):</rdfs:label>
		<ps:sequenceID rdf:datatype="&xsd;int">4</ps:sequenceID>
		<ps:group rdf:resource="&ase;QuoteAdditionalAttributes-Margin"/>
		<rdfs:domain rdf:resource="&as;Quote"/>
		<ps:readOnly rdf:datatype="&xsd;boolean">true</ps:readOnly>
		<rdfs:subPropertyOf rdf:resource="&ps;calculation"/>
		<rdfs:range rdf:resource="&xsd;decimal"/>
	</owl:DatatypeProperty>
	<rdf:Description rdf:about="&ase;zDiscountHeaderPercentage">
		<ps:defaultValue rdf:datatype="&xsd;decimal">0</ps:defaultValue>
		<ps:sparqlDefault rdf:datatype="&xsd;string">
		SELECT ?subject (?val as ?zDiscountHeaderPercentage)
			WHERE {
			?subject ase:zListPriceHeader ?cp .
			?subject ase:zDiscountHeaderTotal ?cc .
			BIND ((xsd:decimal(1)-(( xsd:decimal(?cp) - xsd:decimal(?cc)) / xsd:decimal(?cp)))* xsd:decimal(100) AS ?val)
		}
		</ps:sparqlDefault>
	</rdf:Description>


	<rdf:Description rdf:about="&as;documentHeaderTotalDiscount">
		<ps:defaultValue rdf:datatype="&xsd;decimal">0</ps:defaultValue>
		<ps:sparqlDefault rdf:datatype="&xsd;string">
		SELECT ?subject (?val as ?documentHeaderTotalDiscount)
		WHERE {
			 ?subject as:documentHeaderListPrice ?cc.
			 ?subject as:documentHeaderPrice ?cp.
			 BIND (xsd:decimal(?cc - ?cp) AS ?val)
		}
		</ps:sparqlDefault>
	</rdf:Description>


	<!-- http://www.inmindcomputing.com/application/application-schema-ext.owl#zDocumentHeaderPriceOptional -->

	<owl:DatatypeProperty rdf:about="&ase;zDocumentHeaderPriceOptional">
		<rdf:type rdf:resource="&owl;FunctionalProperty"/>
		<rdfs:label rdf:datatype="&xsd;string">Price optional items</rdfs:label>
		<rdfs:domain rdf:resource="&as;DocumentHeaderPriceItem"/>
		<rdfs:subPropertyOf rdf:resource="&ps;calculation"/>
		<rdfs:subPropertyOf rdf:resource="&ps;materialization"/>
		<rdfs:range rdf:resource="&xsd;decimal"/>
		<ps:defaultValue rdf:datatype="&xsd;decimal">0</ps:defaultValue>
		<ps:sparqlDefault rdf:datatype="&xsd;string">
		SELECT ?subject (SUM(?val) as ?zDocumentHeaderPriceOptional)
		WHERE {

			?subject as:documentHeaderPriceItemIncludedBy ?q.
			?q as:includesSalesItem+ ?si .
			?si as:salesItemOptional false .
			?si as:includesItemHeaderPriceItem ?ihpi .
		{
			  SELECT DISTINCT ?ihpi ?val
			  WHERE
			  {
					 ?ihpi as:itemHeaderTotalPrice ?cp .
					 BIND (xsd:decimal(?cp) AS ?val )
			  }
			}
		} GROUP BY ?subject
		</ps:sparqlDefault>
	</owl:DatatypeProperty>

	<rdf:Description rdf:about="&as;documentHeaderPrice">
		<ps:defaultValue rdf:datatype="&xsd;decimal">0</ps:defaultValue>
		<ps:sparqlDefault rdf:datatype="&xsd;string">
		SELECT ?subject (SUM(?val) as ?documentHeaderPrice)
		WHERE {

			?subject as:documentHeaderPriceItemIncludedBy ?q.
			?q as:includesSalesItem+ ?si .
			?si as:salesItemOptional true .
			?si as:includesItemHeaderPriceItem ?ihpi .
		{
			  SELECT DISTINCT ?ihpi ?val
			  WHERE
			  {
					 ?ihpi ase:itemHeaderSubValue1 ?cp .
					 BIND (xsd:decimal(?cp) AS ?val )
			  }
			}
		} GROUP BY ?subject
		</ps:sparqlDefault>
	</rdf:Description>

    <rdf:Description rdf:about="&as;itemHeaderPrice">
        <ps:defaultValue rdf:datatype="&xsd;decimal">0</ps:defaultValue>
        <ps:sparqlDefault rdf:datatype="&xsd;string">
		SELECT ?subject (?val as ?itemHeaderPrice)
		WHERE {
		   
			?subject rdf:type as:ItemHeaderPriceItem .
			?subject as:includesPriceItem ?pi .
			?pi as:hasPriceItemType ?pt .
			?pt as:objectERPId ?ptid .
				FILTER ( ?ptid = &apos;PR00&apos;) .
			{
			  SELECT DISTINCT ?pi ?val
			  WHERE
			  {
					 ?pi as:priceItemTargetAmount ?cp .
					 BIND (xsd:decimal(?cp) AS ?val )
			  }
			}
		} 
		</ps:sparqlDefault>
    </rdf:Description>
	<!-- http://www.inmindcomputing.com/application/application-schema-ext.owl#itemHeaderSubPrice -->

	<owl:DatatypeProperty rdf:about="&ase;itemHeaderSubPrice">
		<rdf:type rdf:resource="&owl;FunctionalProperty"/>
		<rdfs:label rdf:datatype="&xsd;string">Sub Item Price</rdfs:label>
		<rdfs:domain rdf:resource="&as;ItemHeaderPriceItem"/>
		<rdfs:subPropertyOf rdf:resource="&ps;calculation"/>
		<rdfs:subPropertyOf rdf:resource="&ps;materialization"/>
		<rdfs:range rdf:resource="&xsd;decimal"/>
		<ps:defaultValue rdf:datatype="&xsd;decimal">0</ps:defaultValue>
		<ps:sparqlDefault rdf:datatype="&xsd;string">
		SELECT ?subject (xsd:decimal(SUM(?value)) AS ?itemHeaderSubPrice)
		WHERE { 
		   ?subject as:itemHeaderPriceItemIncludedBy ?salesItem .
		   ?salesItem as:includesSalesItem ?minorSi .
		   ?minorSi as:salesItemOptional true .
		   ?minorSi as:includesItemHeaderPriceItem ?headerPriceItem .
		   ?headerPriceItem as:itemHeaderPrice ?value .
		} GROUP BY ?subject
		</ps:sparqlDefault>
	</owl:DatatypeProperty>

	<!-- http://www.inmindcomputing.com/application/application-schema-ext.owl#itemHeaderSubPrice1 -->

	<owl:DatatypeProperty rdf:about="&ase;itemHeaderSubPrice1">
		<rdf:type rdf:resource="&owl;FunctionalProperty"/>
		<rdfs:label rdf:datatype="&xsd;string">Sub Item Price1</rdfs:label>
		<rdfs:domain rdf:resource="&as;ItemHeaderPriceItem"/>
		<rdfs:subPropertyOf rdf:resource="&ps;calculation"/>
		<rdfs:subPropertyOf rdf:resource="&ps;materialization"/>
		<rdfs:range rdf:resource="&xsd;decimal"/>
		<ps:defaultValue rdf:datatype="&xsd;decimal">0</ps:defaultValue>
		<ps:sparqlDefault rdf:datatype="&xsd;string">
		SELECT ?subject (?val as ?itemHeaderSubPrice1)
		WHERE {
			?subject rdf:type as:ItemHeaderPriceItem .
			?subject as:includesPriceItem ?pi .
			?pi as:hasPriceItemType ?pt .
			?pt as:objectERPId ?ptid .
				FILTER ( ?ptid = &apos;PR00&apos;) .
			{
			  SELECT DISTINCT ?pi ?val
			  WHERE
			  {
					 ?pi as:priceItemTargetAmount ?cp .
					 BIND (xsd:decimal(?cp) AS ?val )
			  }
			}
		   } 
		</ps:sparqlDefault>
	</owl:DatatypeProperty>	

	<rdf:Description rdf:about="&as;itemHeaderPrice">
		<ps:defaultValue rdf:datatype="&xsd;decimal">0</ps:defaultValue>
		<ps:sparqlDefault rdf:datatype="&xsd;string">
		SELECT ?subject ?itemHeaderPrice
		WHERE { 
		   ?subject ase:itemHeaderSubPrice1 ?subValue1 .
		   ?subject ase:itemHeaderSubPrice ?subValue .
		   BIND(xsd:decimal(?subValue + ?subValue1) AS ?itemHeaderPrice)
		}
		</ps:sparqlDefault>
	</rdf:Description>

	<rdf:Description rdf:about="&as;itemHeaderDiscount">
		<ps:defaultValue rdf:datatype="&xsd;decimal">0</ps:defaultValue>
		<ps:sparqlDefault rdf:datatype="&xsd;string">
		SELECT ?subject (?val as ?itemHeaderDiscount)
		WHERE {
			?subject as:itemHeaderPrice ?cp .
			?subject as:itemHeaderNetValue ?cc.
			BIND (((xsd:decimal(?cp) - xsd:decimal(?cc)) / xsd:decimal(?cp))* 100 AS ?val)
		  }
		  </ps:sparqlDefault>
	</rdf:Description>
	<rdf:Description rdf:about="&as;itemHeaderMargin">
		<ps:defaultValue rdf:datatype="&xsd;decimal">0</ps:defaultValue>
		<ps:sparqlDefault rdf:datatype="&xsd;string">
		SELECT ?subject (?val as ?itemHeaderMargin)
		WHERE {
			?subject as:itemHeaderNetValue ?cp .
			?subject as:itemHeaderCost ?cc.
			BIND (xsd:decimal(?cp - ?cc) AS ?val)
		  }
		  </ps:sparqlDefault>
	</rdf:Description>
	<rdf:Description rdf:about="&as;cpqSalesItemDiscount">
		<ps:sparqlDefault rdf:datatype="&xsd;string">
		SELECT ?subject (?val as ?cpqSalesItemDiscount)
		WHERE {
			  ?subject rdf:type as:SalesItem.
			  ?subject as:includesItemHeaderPriceItem ?ih . 
			  ?ih as:itemHeaderPrice ?cp .
			 ?ih as:itemHeaderNetValue ?cc.
		   BIND ( ROUND (((xsd:decimal(?cp) - xsd:decimal(?cc)) / xsd:decimal(?cp))* 100*100)/100 AS ?val)
		  }
		  </ps:sparqlDefault>
	</rdf:Description>

	<rdf:Description rdf:about="&as;cpqQuoteDiscount">
		<ps:sparqlDefault rdf:datatype="&xsd;string">
	SELECT ?subject (?val as ?cpqQuoteDiscount)
	WHERE {
		  ?subject rdf:type as:Quote .
		  ?subject ase:zDiscountHeaderPercentage ?cc . 
	   BIND ( ROUND ((xsd:decimal(?cc))*100)/100 AS ?val)
	  }
	</ps:sparqlDefault>
	</rdf:Description>

	<rdf:Description rdf:about="&as;itemHeaderTotalPrice">
		<ps:defaultValue rdf:datatype="&xsd;decimal">0</ps:defaultValue>
		<ps:sparqlDefault rdf:datatype="&xsd;string">
		SELECT ?subject ?itemHeaderTotalPrice
		WHERE { 
		   ?subject ase:itemHeaderSubValue1 ?subValue1 .
		   ?subject ase:itemHeaderSubValue ?subValue .
		   BIND(xsd:decimal(?subValue + ?subValue1) AS ?itemHeaderTotalPrice)
		}                
		</ps:sparqlDefault>
	</rdf:Description>


	<!-- http://www.inmindcomputing.com/application/application-schema-ext.owl#itemHeaderSubValue -->

	<owl:DatatypeProperty rdf:about="&ase;itemHeaderSubValue">
		<rdf:type rdf:resource="&owl;FunctionalProperty"/>
		<rdfs:label rdf:datatype="&xsd;string">Sub Item Value</rdfs:label>
		<rdfs:domain rdf:resource="&as;ItemHeaderPriceItem"/>
		<rdfs:subPropertyOf rdf:resource="&ps;calculation"/>
		<rdfs:subPropertyOf rdf:resource="&ps;materialization"/>
		<rdfs:range rdf:resource="&xsd;decimal"/>
		<ps:defaultValue rdf:datatype="&xsd;decimal">0</ps:defaultValue>
		<ps:sparqlDefault rdf:datatype="&xsd;string">
		SELECT ?subject (xsd:decimal(SUM(?value)) AS ?itemHeaderSubValue)
		WHERE { 
		   ?subject as:itemHeaderPriceItemIncludedBy ?salesItem .
		   ?salesItem as:includesSalesItem ?minorSi .
		   ?minorSi as:salesItemOptional true .
		   ?minorSi as:includesItemHeaderPriceItem ?headerPriceItem .
		   ?headerPriceItem as:itemHeaderNetValue ?value .
		} GROUP BY ?subject
		</ps:sparqlDefault>
	</owl:DatatypeProperty>

	<!-- http://www.inmindcomputing.com/application/application-schema-ext.owl#itemHeaderSubValue1 -->

	<owl:DatatypeProperty rdf:about="&ase;itemHeaderSubValue1">
		<rdf:type rdf:resource="&owl;FunctionalProperty"/>
		<rdfs:label rdf:datatype="&xsd;string">Sub Item Value1</rdfs:label>
		<rdfs:domain rdf:resource="&as;ItemHeaderPriceItem"/>
		<rdfs:subPropertyOf rdf:resource="&ps;calculation"/>
		<rdfs:subPropertyOf rdf:resource="&ps;materialization"/>
		<rdfs:range rdf:resource="&xsd;decimal"/>
		<ps:defaultValue rdf:datatype="&xsd;decimal">0</ps:defaultValue>
		<ps:sparqlDefault rdf:datatype="&xsd;string">
		SELECT ?subject ?itemHeaderSubValue1
		WHERE { 
		   ?subject as:itemHeaderNetValue ?value .
		   BIND(xsd:decimal(?value ) AS ?itemHeaderSubValue1)
		}
		</ps:sparqlDefault>
	</owl:DatatypeProperty>

	<!-- http://www.inmindcomputing.com/application/application-schema-ext.owl#itemHeaderDiscountValue -->

	<owl:DatatypeProperty rdf:about="&ase;itemHeaderDiscountValue">
		<rdf:type rdf:resource="&owl;FunctionalProperty"/>
		<rdfs:label rdf:datatype="&xsd;string">Discount Value</rdfs:label>
		<rdfs:domain rdf:resource="&as;ItemHeaderPriceItem"/>
		<rdfs:subPropertyOf rdf:resource="&ps;calculation"/>
		<rdfs:subPropertyOf rdf:resource="&ps;materialization"/>
		<rdfs:range rdf:resource="&xsd;decimal"/>
		<ps:defaultValue rdf:datatype="&xsd;decimal">0</ps:defaultValue>
		<ps:sparqlDefault rdf:datatype="&xsd;string">
		SELECT ?subject (?val as ?itemHeaderDiscountValue)
		WHERE {
			?subject as:itemHeaderPrice ?cp .
			?subject as:itemHeaderTotalPrice ?cc.
			BIND ((xsd:decimal(?cp) - xsd:decimal(?cc))  AS ?val)
		}
		 </ps:sparqlDefault>
	</owl:DatatypeProperty>

	<rdf:Description rdf:about="&as;itemHeaderUnitPrice">
		<ps:defaultValue rdf:datatype="&xsd;decimal">0</ps:defaultValue>
		<ps:sparqlDefault rdf:datatype="&xsd;string">
		SELECT ?subject (?val as ?itemHeaderUnitPrice)
		WHERE {
			?subject as:itemHeaderNetPrice ?cp .
			BIND (xsd:decimal(?cp)  AS ?val)
		}
		</ps:sparqlDefault>
	</rdf:Description>
	<rdf:Description rdf:about="&as;documentHeaderDiscount">
		<ps:defaultValue rdf:datatype="&xsd;decimal">0</ps:defaultValue>
		<ps:sparqlDefault rdf:datatype="&xsd;string">
		SELECT DISTINCT ?subject (?val as ?documentHeaderDiscount)
		WHERE {
			?subject as:documentHeaderListPrice ?cp .
			?subject as:documentHeaderTotalDiscount ?cc .
			BIND ( xsd:decimal((xsd:decimal(?cp - ?cc)) / xsd:decimal(?cp)) * xsd:decimal(100)   AS ?val )
		}
		</ps:sparqlDefault>
	</rdf:Description>
	<rdf:Description rdf:about="&as;itemHeaderAdditionalPrice">
		<ps:defaultValue rdf:datatype="&xsd;decimal">0</ps:defaultValue>
		<ps:sparqlDefault rdf:datatype="&xsd;string">
		SELECT DISTINCT ?subject (?val as ?itemHeaderAdditionalPrice)
		WHERE {
			?subject as:itemHeaderPrice ?cp .
			?subject as:itemHeaderUnitPrice ?cup .
			OPTIONAL { ?subject as:itemHeaderDiscount ?ihd . }
			BIND ( IF (BOUND(?ihd), abs(?ihd), 0) AS ?discount ) .
			BIND ( xsd:decimal( ( ?cup + (?cp * ?discount / 100) ) - ?cp) AS ?val )
		  }
		</ps:sparqlDefault>
	</rdf:Description>

	<rdf:Description rdf:about="&as;itemHeaderCost">
		<ps:defaultValue rdf:datatype="&xsd;decimal">0</ps:defaultValue>
		<ps:sparqlDefault rdf:datatype="&xsd;string">
		SELECT ?subject (?val as ?itemHeaderCost)
		WHERE {
			?subject rdf:type as:ItemHeaderPriceItem .
			?subject as:includesPriceItem ?pi .
			?pi as:hasPriceItemType ?pt .
			?pt as:objectERPId ?ptid .
				FILTER ( ?ptid = &apos;VPRS&apos;) .
			{
			  SELECT DISTINCT ?pi ?val
			  WHERE
			  {
					 ?pi as:priceItemTargetAmount ?cp .
					 BIND (xsd:decimal(?cp) AS ?val )
			  }
			}
		   } 
		</ps:sparqlDefault>
	</rdf:Description>
	<rdf:Description rdf:about="&as;documentHeaderListPrice">
		<ps:defaultValue rdf:datatype="&xsd;decimal">0</ps:defaultValue>
		<ps:sparqlDefault rdf:datatype="&xsd;string">
		SELECT ?subject (sum(?val) as ?documentHeaderListPrice)
		WHERE {
		   ?subject as:documentHeaderPriceItemIncludedBy ?q.
			?q as:includesSalesItem+ ?si .
			?si as:salesItemOptional true .
			?si as:includesItemHeaderPriceItem ?ihpi .
			?ihpi as:includesPriceItem ?pi .
			?pi as:hasPriceItemType ?pt .
				?pt as:objectERPId ?ptid .
				FILTER ( ?ptid = &apos;PR00&apos;) .
			{
			  SELECT DISTINCT ?pi ?val
			  WHERE
			  {
					 ?pi as:priceItemTargetAmount ?cp .
					 BIND (xsd:decimal(?cp) AS ?val )
			  }
		   }}
		  GROUP BY ?subject
		</ps:sparqlDefault>
	</rdf:Description>

	<rdf:Description rdf:about="&as;quoteId">
		<rdfs:comment rdf:datatype="&xsd;string">Quote ID</rdfs:comment>
		<ps:sparqlDefault rdf:datatype="&xsd;string">
		SELECT ?subject ?quoteId 
		where { 
			?subject rdf:type as:Quote . 
			?subject ps:objectExternalId ?external .
		  BIND( IF (BOUND(?external), ?external, 
			concat(&quot;CPQ&quot;, ps:leftPad(ps:sequence(&apos;QUOTESEQUENCE&apos; , 5, &apos;0&apos; ))))
			AS ?quoteId)
		}
		</ps:sparqlDefault>
	</rdf:Description>
	<rdf:Description rdf:about="&as;quoteTotalDiscount">
		<ps:defaultValue rdf:datatype="&xsd;decimal">0</ps:defaultValue>
		<ps:sparqlDefault rdf:datatype="&xsd;string">
		SELECT ?subject (?val as ?quoteTotalDiscount)
			WHERE {
			  ?subject as:documentHeaderListPrice ?priceBeforeDiscount .
			  ?subject as:documentHeaderPrice ?priceAfterDiscount .
			  BIND ( ((xsd:decimal(?priceBeforeDiscount) - xsd:decimal(?priceAfterDiscount) ) / xsd:decimal(?priceBeforeDiscount)) *
			  100 AS ?val)
			  }
		</ps:sparqlDefault>
	</rdf:Description>
</rdf:RDF>



<!-- Generated by the OWL API (version 3.4.2) http://owlapi.sourceforge.net -->

